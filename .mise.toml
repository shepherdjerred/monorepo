# Mise configuration for monorepo development
# Run `mise run dev` to set up your development environment

[tools]
bun = "latest"
dagger = "latest"

[tasks.dev]
description = "Set up the development environment for all packages"
run = """
#!/usr/bin/env bash
set -e

echo "Setting up development environment..."

# Trust mise configuration
echo "Trusting mise configuration..."
mise trust

# Install root dependencies
echo "Installing root dependencies..."
bun install

# Install dagger module dependencies
echo "Installing dagger module dependencies..."
cd .dagger && bun install && cd ..

# Run dagger develop to generate SDK
echo "Running dagger develop..."
dagger develop

# Generate Prisma client for birmel
echo "Generating Prisma client for birmel..."
cd packages/birmel && bunx prisma generate && cd ../..

echo "Development environment setup complete!"
"""

[tasks.install]
description = "Install all dependencies (alias for dev)"
depends = ["dev"]

[tasks.prisma]
description = "Generate Prisma client for birmel"
run = "cd packages/birmel && bunx prisma generate"

[tasks.dagger]
description = "Run dagger develop to generate SDK"
run = "dagger develop"
