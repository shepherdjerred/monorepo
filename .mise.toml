# Mise configuration for monorepo development
# Run `mise run dev` to set up your development environment

[tools]
bun = "latest"
dagger = "latest"

[tasks.dev]
description = "Set up the development environment for all packages"
run = """
#!/usr/bin/env bash
set -e

echo "ğŸ”§ Setting up development environment..."

# Trust mise configuration
echo "ğŸ“‹ Trusting mise configuration..."
mise trust

# Install mise tools (bun, dagger, etc.)
echo "ğŸ› ï¸  Installing mise tools..."
mise install

# Install root dependencies
echo "ğŸ“¦ Installing root dependencies..."
bun install

# Install dagger module dependencies
echo "ğŸ“¦ Installing dagger module dependencies..."
cd .dagger && bun install && cd ..

# Run dagger develop to generate SDK
echo "ğŸš€ Running dagger develop..."
dagger develop

# Generate Prisma client for birmel
echo "ğŸ—„ï¸  Generating Prisma client for birmel..."
cd packages/birmel && bunx prisma generate && cd ../..

echo "âœ… Development environment setup complete!"
"""

[tasks.install]
description = "Install all dependencies (alias for dev)"
depends = ["dev"]

[tasks.prisma]
description = "Generate Prisma client for birmel"
run = "cd packages/birmel && bunx prisma generate"

[tasks.dagger]
description = "Run dagger develop to generate SDK"
run = "dagger develop"
